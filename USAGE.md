# Usage Guide

This guide shows you how to use `@testgen/ai` in your projects.

## Installation

```bash
npm install -D @testgen/ai
```

## Quick Start

### 1. Initialize

Run the initialization command in your project root:

```bash
npx testgen-init
```

This will:
- ‚úÖ Auto-detect your project type (React, .NET, Node.js, etc.)
- ‚úÖ Auto-detect your testing framework (Jest, xUnit, NUnit, etc.)
- ‚úÖ Create test directory structure
- ‚úÖ Configure everything automatically

### 2. Use with AI IDE

Open your AI IDE (Cursor, VS Code + Copilot, JetBrains, etc.) and use prompts like:

**For React Component Tests:**
```
Using @testgen/ai Jest + React prompt, generate unit tests for:
- Component: UserProfile
- Source File: src/components/UserProfile.tsx
- Test scenarios: 
  - Component renders with user data
  - Component handles edit button click
  - Component displays error message on API failure
```

**For Node.js Function Tests:**
```
Using @testgen/ai Jest Node.js prompt, generate unit tests for:
- Function: calculateTotal
- Source File: src/utils/calculator.ts
- Test scenarios:
  - Function calculates total correctly
  - Function handles empty array
  - Function throws error for invalid input
```

**For .NET Class Tests:**
```
Using @testgen/ai xUnit .NET prompt, generate unit tests for:
- Class: UserService
- Source File: Services/UserService.cs
- Test scenarios:
  - GetUserById returns user for valid ID
  - GetUserById throws NotFoundException for invalid ID
  - CreateUser creates user successfully
```

### 3. Run Tests

Use your framework's test runner:

```bash
# Jest
npm test
# or
npx jest

# Vitest
npx vitest

# .NET
dotnet test
```

## CLI Commands

### `testgen-init`

Initialize the package in your project.

```bash
npx testgen-init
```

This command:
- Auto-detects project type and testing framework
- Creates test directories if needed
- Shows detected configuration

### `testgen-generate`

Generate test generation prompts for AI agents.

```bash
# Show all available frameworks
npx testgen-generate

# Show specific framework prompt
npx testgen-generate jest-react
npx testgen-generate jest-node
npx testgen-generate xunit
npx testgen-generate nunit
npx testgen-generate vitest

# Auto-detect framework
npx testgen-generate auto
```

### `testgen-run`

Helper command to show how to run tests.

```bash
npx testgen-run
```

Shows framework-specific test commands.

## Project Types

The package auto-detects and supports:

### React Projects
- ‚úÖ Vite
- ‚úÖ Create React App
- ‚úÖ Next.js
- ‚úÖ Remix

### .NET Projects
- ‚úÖ .NET 8
- ‚úÖ ASP.NET Core
- ‚úÖ Class Libraries

### Node.js Projects
- ‚úÖ Express
- ‚úÖ Fastify
- ‚úÖ NestJS
- ‚úÖ Plain Node.js

### Other Frameworks
- ‚úÖ Vue.js
- ‚úÖ Angular
- ‚úÖ Svelte

## Testing Frameworks

### Jest
- **React**: Uses React Testing Library
- **Node.js**: Standard Jest testing
- **Auto-detected**: From `package.json` dependencies

### xUnit (.NET)
- **Auto-detected**: From `.csproj` files
- **Test Directory**: `Tests/` by default
- **Namespace**: Matches source namespace with `.Tests` suffix

### NUnit (.NET)
- **Auto-detected**: From `.csproj` files
- **Test Directory**: `Tests/` by default

### Vitest
- **Auto-detected**: From `package.json` or `vitest.config.ts`
- **Test Directory**: Co-located or `__tests__/`

## Configuration

### Zero-Config (Default)

The package works out of the box with auto-detection. No configuration needed!

### Custom Configuration

Create `testgen.config.js` in your project root:

```javascript
export default {
  projectType: 'react',
  testingFramework: 'jest',
  testDirectory: './__tests__',
  sourceDirectory: './src',
  frameworkConfig: {
    jest: {
      configFile: 'jest.config.js',
      testMatch: ['**/__tests__/**/*', '**/*.test.*'],
    },
    xunit: {
      namespace: 'Tests',
      testDirectory: 'Tests',
    },
  },
};
```

## IDE Setup

### Cursor

The `init` command automatically detects Cursor. Prompts work immediately - no configuration needed!

### VS Code + GitHub Copilot

1. Install the package: `npm install -D @testgen/ai`
2. Use prompts in Copilot Chat
3. No additional configuration needed

### JetBrains IDEs

1. Install the package: `npm install -D @testgen/ai`
2. Use prompts in AI Assistant
3. No additional configuration needed

### Other IDEs

The prompts in `prompts/universal/` are IDE-agnostic. Copy them into your AI IDE's chat.

## Examples

### Example 1: React Component Testing

```typescript
// Generated by AI using @testgen/ai prompts
import { render, screen, fireEvent } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import { UserProfile } from './UserProfile';

describe('UserProfile', () => {
  test('should render with user data', () => {
    render(<UserProfile user={{ name: 'John', email: 'john@example.com' }} />);
    expect(screen.getByText('John')).toBeInTheDocument();
  });

  test('should handle edit button click', async () => {
    const user = userEvent.setup();
    render(<UserProfile user={{ name: 'John' }} />);
    
    const editButton = screen.getByRole('button', { name: /edit/i });
    await user.click(editButton);
    
    expect(screen.getByRole('textbox')).toBeInTheDocument();
  });
});
```

### Example 2: Node.js Function Testing

```typescript
// Generated by AI using @testgen/ai prompts
import { calculateTotal } from './calculator';

describe('calculateTotal', () => {
  test('should calculate total correctly', () => {
    const items = [10, 20, 30];
    expect(calculateTotal(items)).toBe(60);
  });

  test('should handle empty array', () => {
    expect(calculateTotal([])).toBe(0);
  });

  test('should throw error for invalid input', () => {
    expect(() => calculateTotal(null)).toThrow('Invalid input');
  });
});
```

### Example 3: .NET xUnit Testing

```csharp
// Generated by AI using @testgen/ai prompts
using Xunit;
using Moq;

namespace Tests
{
    public class UserServiceTests
    {
        private readonly Mock<IUserRepository> _mockRepository;
        private readonly UserService _sut;

        public UserServiceTests()
        {
            _mockRepository = new Mock<IUserRepository>();
            _sut = new UserService(_mockRepository.Object);
        }

        [Fact]
        public void GetUserById_WithValidId_Should_ReturnUser()
        {
            // Arrange
            var userId = 1;
            var expectedUser = new User { Id = userId, Name = "John" };
            _mockRepository.Setup(x => x.GetById(userId)).Returns(expectedUser);
            
            // Act
            var result = _sut.GetUserById(userId);
            
            // Assert
            Assert.Equal(expectedUser, result);
        }
    }
}
```

## Troubleshooting

### "Command not found: testgen-init"

Make sure the package is installed:
```bash
npm install -D @testgen/ai
```

### Framework not detected

The package auto-detects frameworks from:
- `package.json` dependencies (Jest, Vitest, etc.)
- `.csproj` files (.NET frameworks)
- Config files (`jest.config.js`, `vitest.config.ts`, etc.)

If detection fails, specify the framework manually:
```bash
npx testgen-generate jest-react
```

### Tests not generating correctly

Make sure to:
1. Provide clear source file paths
2. Specify component/function/class names
3. Include test scenarios
4. Use the correct framework prompt

## Advanced Usage

### Custom Test Generators

You can extend the test generation by creating custom prompts:

```typescript
import { TestGenerator } from '@testgen/ai';

const generator = new TestGenerator();
const prompt = generator.generatePrompt({
  framework: 'jest',
  projectType: 'react',
  componentName: 'CustomComponent',
  description: 'Generate tests for custom component',
  scenarios: ['renders correctly', 'handles interactions'],
});
```

### Framework Detection

```typescript
import { FrameworkDetector } from '@testgen/ai';

const detector = new FrameworkDetector(process.cwd());
const detected = await detector.detect();
console.log(`Framework: ${detected.framework}`);
console.log(`Project Type: ${detected.projectType}`);
```

## Support

- üìñ [Full Documentation](./README.md)
- üêõ [Report Issues](https://github.com/DivyamPant2803/testgen-ai/issues)
- üí¨ [Discussions](https://github.com/DivyamPant2803/testgen-ai/discussions)



